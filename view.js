const resumeData = { "importantDetails": { "email": "sundaraguru@gmail.com", "experience": "20y", "mobile": "+91", "name": "Sundaraguru Sundaramahalingam", "primarySkills": "SSIS [11Yr:in2017]; SSRS [11Yr:in2017]; Ssas Tabular [2Yr:in2017]; Power Pivot [2Yr:in2017]; SQL [11Yr:in2017]; C#.Net [4Yr:in2017]; T- [13Yr:in2017]; AutoSys [6Yr:in2017]; SVN [7Yr:in2017]; VSS/Clearcase [8Yr:in2015]; Datastage [2Yr:in2014]; Toad [3Yr:in2017]; Pl/ [4Yr:in2017];" }, "otherDetails": { "certifications": [{ "course": "Microsoft Certified Professional", "vendor": "SQL Server 2008 Database Development" }, { "course": "Azure Data Engineer", "vendor": "Microsoft" }, { "course": "Azure Infrastructure Solution Architect", "vendor": "Microsoft" }], "currentRole": { "company": "Infosys", "position": "Technical Architect (Data ETL NoSQL)", "since": "Jul '17" }, "desiredJob": { "employmentStatus": "Full time", "jobType": "Permanent" }, "educationDetails": [{ "degree": "MS/M.Sc(Science)", "field": "Computers", "institution": "Madurai Kamaraj University, Madurai", "type": "PG", "year": "2002 PG" }, { "degree": "B.Sc", "field": "Computers", "institution": "Madurai Kamaraj University, Madurai", "type": "UG", "year": "2000 UG" }], "highestDegree": { "degree": "MS/M.Sc(Science)", "institution": "Madurai Kamaraj University, Madurai" }, "itSkills": [{ "experience": "11y", "lastUsed": "2017", "skill": "SSIS", "version": "2012" }, { "experience": "11y", "lastUsed": "2017", "skill": "SSRS", "version": "2012" }, { "experience": "2y", "lastUsed": "2017", "skill": "Ssas Tabular", "version": "2012" }, { "experience": "2y", "lastUsed": "2017", "skill": "Power Pivot", "version": "- -" }, { "experience": "11y", "lastUsed": "2017", "skill": "SQL Server", "version": "2012" }, { "experience": "4y", "lastUsed": "2017", "skill": "C#.Net", "version": "- -" }, { "experience": "13y", "lastUsed": "2017", "skill": "T-SQL", "version": "2012" }, { "experience": "6y", "lastUsed": "2017", "skill": "AutoSys", "version": "- -" }, { "experience": "7y", "lastUsed": "2017", "skill": "SVN", "version": "- -" }, { "experience": "8y", "lastUsed": "2015", "skill": "VSS/Clearcase", "version": "- -" }, { "experience": "2y", "lastUsed": "2014", "skill": "Datastage", "version": "7.0" }, { "experience": "3y", "lastUsed": "2017", "skill": "Toad", "version": "- -" }, { "experience": "4y", "lastUsed": "2017", "skill": "Pl/Sql", "version": "- -" }], "jobInfo": { "currentSalary": "₹ 27.70 Lacs", "expectedSalary": "₹ 40.0 Lacs", "linkedin": "", "location": "Chennai", "noticePeriod": "3 Months" }, "languages": [{ "capabilities": "Read,Write,Speak", "language": "English", "proficiency": "Expert" }, { "capabilities": "Read,Write,Speak", "language": "Tamil", "proficiency": "Expert" }], "metadata": { "downloads": "", "lastActive": "Active in 2022", "lastUpdated": "Last updated on 19 May, '19", "views": "" }, "otherProjects": [{ "company": "Project Leader at The Hartford Financial Services Group Inc., Connecticut, USA(Full time, Onsite)", "description": "As part of QAT/OCUO Report Platform we were replacing MS Access reporting tool with Microsoft Business Intelligence (MSBI), since current environment is vulnerable to desktop and server upgrades leading to application breakage. As part to report design we have create filters, drilldowns and the ability to designate the inclusion of desired columns (using Self Service BI Capability). Main Objective of base report should give users the ability to request and present data in easiest and most user friendly approach.", "duration": "Mar '16 till date", "name": "Commercial Lines - QAT/OCUO Report Platform", "role": "Designing reports using SQL Server Reporting Services (SSRS-SP Mode). Creating SSAS Tabular Model for Self Service Reporting capability and deploying in Server Creating Perspective & Roles to Model and maintain the proper access based Mapping", "skills": "SQL Server 2012 (SSRS-SP Integrated Mode, SSIS, SSAS Tabular), Oracle 12c, Autosys, SVN and Windows 2012", "teamInfo": "SQL", "type": "Other Project" }, { "company": "Module Leader at The Hartford Financial Services Group Inc., Connecticut, USA(Full time, Onsite)", "description": "The Hartford Group Benefits’ current policy administration relies on outdated legacy systems. Tactical changes made over time have resulted in redundant data entry, workarounds and other efficiency challenges. Policy data does not flow efficiently from Pre-Sale to Sold-Case for all size cases and there is no single version of the truth for sold case data. The case installation process has been continuously improved and a business maintained implementation log is used today to capture sold case policy data manually for most business; case assignment and capacity management are also done using business developed tools. There is an opportunity to automate the implementation log, workflow, tracking, reporting and capacity management.As part of Implementation log project, there will be automated transmission of 1,000+ life case pre-sale data from Rating/Quote Tracking (RA/QT) into sold case data (PRISM). Hence PRISM will contain Post sale data / pre sale data of Q.", "duration": "Jan '16 to May '16", "name": "Group Benefits – Automation of Implementation Log Project", "role": "Development of database objects like Tables, Stored Procedures, Triggers, Views & Indexes using Transact SQL as per the business & functional requirements using Microsoft SQL Server Initiated and implemented best practices, standard and guidelines", "skills": "SQL Server 2012 (T-SQL, SSRS), Oracle 11g, Informatica PowerCenter 9, Autosys, SVN and Windows 2012", "teamInfo": "SQL", "type": "Other Project" }, { "company": "Sr. Programmer at Hartford Investment Management Company, Connecticut, USA(Full time, Onsite)", "description": "Hartford Investment Management Company ('HIMCO') is the asset management arm of the Hartford Financial Services Group, Inc. (The Hartford). In addition to the assets managed for the General Account of The Hartford, HIMCO manages assets for both institutional and retail investors across the global fixed income, equity and alternative markets. As of 6/30/15, HIMCO currently manages over $106.1 billion dollars in assets. As part of SSAS Migration project, all HIMCO SQL Server environments were migrated to Windows 2012 R2 and SQL Server 2012. Migrated the SQL Server relational databases & SSAS Cubes from Old (2005) to new (2012) environment. Migrated the SSRS reports and update the MDX query to use 2012 standards.", "duration": "Aug '15 to Dec '15", "name": "HIMCO – SSAS Migration Project", "role": "Responsible for Data migration from SQL Server 2005 to SQL Server 2012 Databases. Created & Migrated Cube in SSAS Multidimensional Cubes Deployed/Designed cubes in SSAS environment Snowflake/ and Star Schema Designs for data warehouse purposes.", "skills": "MS SQL Server 2012 (T-SQL, SSAS, SSIS, SSRS), ASCMD, Autosys, SVN and Windows 2012", "teamInfo": "MS", "type": "Other Project" }, { "company": "Module Leader at The Hartford Financial Services Group Inc., Connecticut, USA(Full time, Offsite)", "description": "The Hartford Group Benefits has a gap its ability to obtain and utilize analytical (unstructured) data and traditional data to provide The Hartford with the ability to perform predictive and trending analytics for taking action and making decisions. Having this capability will allow us the potential to surpass our competitors by being more proactive rather than reactive. This project will provide the ability to predict future disability claims, leverage resources as appropriate in various stages of claims and provide a differentiated offering by being proactive instead or reactive. As part of this project, a foundation of GBC Operational data called GB Data warehouse and data marts are created which support data for predictive and trending analytics. Data from various sources like Leave Management System, Disability Claim Systems, Claim Quality System and Claim Loyalty System are extracted into staging areas and business rules are applied on top of that and finally loaded into DWH & DM", "duration": "Aug '14 to Jul '15", "name": "Group Benefits – Claims Analytics", "role": "Analyzed the source systems; identified data rules, violations and cleansing strategies Created custom code in SSIS packages to push the SSRS Report output to SharePoint. Defined standards and implemented a framework and template for SSIS developmen", "skills": "SQL Server 2012 (T-SQL, SSIS, SSRS), Oracle 11g, Informatica PowerCenter 9, SQL AGENT & Autosys", "teamInfo": "SQL", "type": "Other Project" }], "personalDetails": { "category": "Category", "dob": "20 May 1979", "gender": "Gender", "maritalStatus": "Marital status", "physicallyChallenged": "Physically Challenged" }, "preferredLocations": ["Chennai"], "profileSummary": "I'm writing to apply for the position of Data &ETL Architect. Having knowledge in DataStage, Microsoft Business Intelligence (SSIS, SSRS, SSAS) & Power BI I believe my knowledge of BI experience would make me a great addition to your workforce.", "skills": { "additionalSkills": ["Data Modeling", "OLAP", "Etl Development", "Ibm Datastage"], "assessedSkills": [], "keySkills": ["Datastage", "UNIX", "SQL", "Datastage Developer", "PLSQL", "Teradata", "ETL Tool", "DW", "ETL", "Datastage ETL", "Data Warehousing", "DWBI", "Oracle", "T-SQL", "SSIS", "Hadoop Development", "Pyspark", "Power BI", "SSAS", "SSRS", "Business Intelligence", "C#", "SQL Server", "SQL Azure", "Data Modeling", "OLAP", "Etl Development", "Ibm Datastage"] }, "workAuthorization": { "otherCountries": "India", "usStatus": "Have US H1 Visa" }, "workExperiences": [{ "company": "Infosys", "description": "Working as Technical Architect", "duration": "Jul '17 till date ( 7y 10m )", "position": "Technical Architect (Data ETL NoSQL)" }, { "company": "Cognizant Technologies Solutions", "description": "MSBI or ETL Lead Consultant (SSIS, SSRS & SSAS)", "duration": "Aug '14 till May '17 ( 2y 9m )", "position": "Manager Project" }, { "company": "Randstad", "description": "Senior MSBI / SSIS ETL Developer", "duration": "Feb '14 till Jul '14 ( 5m )", "position": "Senior Software Developer" }, { "company": "Infosys", "description": "", "duration": "May '10 till Feb '14 ( 3y 9m )", "position": "Technology Lead" }, { "company": "Wipro Technologies", "description": "", "duration": "Sep '07 till Apr '10 ( 2y 7m )", "position": "Senior Software Engineer" }, { "company": "Apollo Health Street", "description": "", "duration": "Nov '06 till Aug '07 ( 9m )", "position": "Software Engineer" }, { "company": "Icomm Technologies", "description": "", "duration": "Oct '05 till Oct '06 ( 1y )", "position": "Software Engineer" }, { "company": "Leela InfoTech", "description": "", "duration": "Dec '03 till Sep '05 ( 1y 9m )", "position": "Software Engineer" }], "workSummary": "18+ years of Software Development experience in the various facets of ETL Requirements elicitation, data modeling, T-SQL Development, ETL Design, Implementation and reporting solutions. Extensively worked in developing solutions using Business Intelligence tools like DataStage, DTS, SSIS SSRS, SSAS 12+ years of experience in managing team in a Global delivery model engagements. Specialties: MS SQL Server (7.0 to 2012), SSIS (2005 to 2012), SSRS (2005 to 2012), SSAS, Oracle, Power BI (Power Pivot, Power View, Power Map), Visual Basic 6.0, VBA, IBM DataStage, Netezza, MS Visio, ErWin, Autosys" } };


var ResumeViewer = (function () {
    /**
     * Validates if a string is valid JSON
     * @param {string} str - String to validate as JSON
     * @return {boolean} True if valid JSON, false otherwise
     */
    function isJSON(str) {
        try {
            JSON.parse(str);
            return true;
        } catch (e) {
            return false;
        }
    }

    /**
     * Displays a status message to the user that auto-dismisses
     * @param {string} message - The message to display
     * @param {string} type - The alert type (success, warning, danger, etc.)
     */
    function displayStatus(message, type) {
        // Create the modal HTML elements
        var modal = document.createElement('div');
        modal.className = 'modal fade';
        modal.id = 'statusModal';
        modal.role = 'dialog';
        modal.tabIndex = '-1';

        var modalDialog = document.createElement('div');
        modalDialog.className = 'modal-dialog';
        modalDialog.role = 'document';

        var modalContent = document.createElement('div');
        modalContent.className = 'modal-content';

        var modalHeader = document.createElement('div');
        modalHeader.className = 'modal-header';

        var modalTitle = document.createElement('h5');
        modalTitle.className = 'modal-title';
        modalTitle.textContent = type.charAt(0).toUpperCase() + type.slice(1) + ' Message';

        var closeButton = document.createElement('button');
        closeButton.type = 'button';
        closeButton.className = 'close';
        closeButton.setAttribute('data-dismiss', 'modal');
        closeButton.setAttribute('aria-label', 'Close');
        closeButton.innerHTML = '&times;';

        var modalBody = document.createElement('div');
        modalBody.className = 'modal-body';

        var statusMessageText = document.createElement('p');
        statusMessageText.id = 'statusMessageText';
        statusMessageText.textContent = message;

        // Set the modal background color based on the type
        switch (type) {
            case 'success':
                modalContent.style.backgroundColor = '#C6F4D6'; // light green
                break;
            case 'error':
                modalContent.style.backgroundColor = '#F2C4C5'; // light red
                break;
            case 'warning':
                modalContent.style.backgroundColor = '#F7D2C4'; // light yellow
                break;
            default:
                modalContent.style.backgroundColor = '#FFFFFF'; // default white
        }

        // Assemble the modal
        modalHeader.appendChild(modalTitle);
        modalHeader.appendChild(closeButton);
        modalContent.appendChild(modalHeader);
        modalContent.appendChild(modalBody);
        modalBody.appendChild(statusMessageText);
        modalDialog.appendChild(modalContent);
        modal.appendChild(modalDialog);

        // Add the modal to the page
        document.body.appendChild(modal);

        // Show the modal
        $(modal).modal('show');

        // Hide the modal after 5 seconds
        setTimeout(function () {
            $(modal).modal('hide');
            // Remove the modal from the page
            modal.parentNode.removeChild(modal);
        }, 5000);
    }

    // Component renderers
    var renderers = {
        /**
         * Renders work experience section
         * @param {Array} experiences - Array of work experience objects
         * @return {string} HTML content for work experiences
         */
        workExperiences: function (experiences) {
            if (!experiences || !Array.isArray(experiences) || experiences.length === 0) {
                return '<div class="alert alert-warning rounded-lg shadow-sm">' +
                    '<i class="fas fa-exclamation-circle mr-2"></i> No work experience found</div>';
            }

            var tableRows = '';
            for (var i = 0; i < experiences.length; i++) {
                var exp = experiences[i];
                tableRows += '<tr class="experience-row">' +
                    '<td class="font-weight-medium">' + (exp.company || 'N/A') + '</td>' +
                    '<td>' + (exp.position || 'N/A') + '</td>' +
                    '<td><span class="badge badge-light">' + (exp.duration || 'N/A') + '</span></td>' +
                    '<td class="text-muted small">' + (exp.description || 'N/A') + '</td>' +
                    '</tr>';
            }

            return '<div class="table-responsive card shadow-sm">' +
                '<table class="table table-hover mb-0">' +
                '<thead class="bg-gradient-primary text-white">' +
                '<tr><th class="border-0">Company</th>' +
                '<th class="border-0">Position</th>' +
                '<th class="border-0">Duration</th>' +
                '<th class="border-0">Description</th></tr>' +
                '</thead><tbody>' + tableRows + '</tbody></table></div>';
        },

        /**
         * Renders education details section
         * @param {Array} education - Array of education detail objects
         * @return {string} HTML content for education details
         */
        educationDetails: function (education) {
            if (!education || !Array.isArray(education) || education.length === 0) {
                return '<div class="alert alert-warning rounded-lg shadow-sm">' +
                    '<i class="fas fa-exclamation-circle mr-2"></i> No education details found</div>';
            }

            var tableRows = '';
            for (var i = 0; i < education.length; i++) {
                var edu = education[i];
                tableRows += '<tr class="education-row">' +
                    '<td class="font-weight-medium">' + (edu.degree || 'N/A') + '</td>' +
                    '<td>' + (edu.field || 'N/A') + '</td>' +
                    '<td>' + (edu.institution || 'N/A') + '</td>' +
                    '<td><span class="badge badge-light">' + (edu.year || 'N/A') + '</span></td>' +
                    '<td>' + (edu.type || 'N/A') + '</td>' +
                    '</tr>';
            }

            return '<div class="table-responsive card shadow-sm">' +
                '<table class="table table-hover mb-0">' +
                '<thead class="bg-gradient-primary text-white">' +
                '<tr><th class="border-0">Degree</th>' +
                '<th class="border-0">Field</th>' +
                '<th class="border-0">Institution</th>' +
                '<th class="border-0">Year</th>' +
                '<th class="border-0">Type</th></tr>' +
                '</thead><tbody>' + tableRows + '</tbody></table></div>';
        },

        /**
         * Renders highest degree section
         */
        highestDegree: function (degree) {
            if (!degree || typeof degree !== 'object') {
                return '<div class="alert alert-warning rounded-lg shadow-sm">' +
                    '<i class="fas fa-exclamation-circle mr-2"></i> No degree found</div>';
            }

            return '<div class="card shadow-sm p-0">' +
                '<ul class="list-group list-group-flush">' +
                '<li class="list-group-item">' +
                '<div><i class="fas fa-graduation-cap text-primary mr-2"></i>' +
                '<span class="font-weight-medium">' + (degree.degree || 'N/A') + '</span></div>' +
                '<span class="badge badge-soft-primary badge-pill">' + (degree.institution || 'N/A') + '</span>' +
                '</li></ul></div>';
        },


        /**
         * Renders work summary by splitting into component items
         */
        workSummary: function (workSummary) {
            if (!workSummary || typeof workSummary !== 'string') {
                return '<div class="alert alert-warning rounded-lg shadow-sm">' +
                    '<i class="fas fa-exclamation-circle mr-2"></i> No work summary found</div>';
            }

            var summary = [];

            // First try splitting by newlines
            var lineItems = workSummary.split('\n')
                .map(function (item) { return item.trim(); })
                .filter(function (item) { return item; });

            if (lineItems.length > 1) {
                summary = lineItems;
            } else if (workSummary.includes('•')) {
                // Try bullet points
                summary = workSummary.split('•')
                    .map(function (item) { return item.trim(); })
                    .filter(function (item) { return item; });
            } else {
                // Try sentences (avoiding breaking decimal numbers)
                var text = workSummary.replace(/\n/g, ' ');
                var sentences = text.split(/\.(?=\s|$)/g)
                    .map(function (item) { return item.trim(); })
                    .filter(function (item) { return item; });

                if (sentences.length > 0) {
                    summary = sentences;
                } else {
                    // Last resort: split by commas
                    summary = text.split(',')
                        .map(function (item) { return item.trim(); })
                        .filter(function (item) { return item; });
                }
            }

            if (summary.length === 0) {
                return '<div class="alert alert-warning rounded-lg shadow-sm">' +
                    '<i class="fas fa-exclamation-circle mr-2"></i> No work summary found</div>';
            }

            var tableRows = '';
            for (var i = 0; i < summary.length; i++) {
                tableRows += '<tr class="summary-row">' +
                    '<td class="text-muted">' + (summary[i] || 'N/A') + '</td>' +
                    '</tr>';
            }

            return '<div class="table-responsive card shadow-sm">' +
                '<table class="table table-hover mb-0">' +
                '<thead class="bg-gradient-primary text-white">' +
                '<tr><th class="border-0">Summary</th></tr>' +
                '</thead><tbody>' + tableRows + '</tbody></table></div>';
        },

        /**
         * Renders work authorization details
         */
        workAuthorization: function (workAuth) {
            if (!workAuth || typeof workAuth !== 'object') {
                return '<div class="alert alert-warning rounded-lg shadow-sm">' +
                    '<i class="fas fa-exclamation-circle mr-2"></i> No work authorization found</div>';
            }

            return '<div class="card shadow-sm p-0">' +
                '<ul class="list-group list-group-flush">' +
                '<li class="list-group-item d-flex justify-content-between align-items-center">' +
                '<div><i class="fas fa-briefcase text-primary mr-2"></i>' +
                '<span class="font-weight-medium">' + (workAuth.usStatus || 'N/A') + '</span></div>' +
                '<span class="badge badge-soft-info badge-pill">' + (workAuth.otherCountries || 'N/A') + '</span>' +
                '</li></ul></div>';
        },

        /**
         * Renders technical skills
         * @param {Array} skills - Array of technical skill objects
         * @return {string} HTML content for technical skills
         */
        technicalSkills: function (skills) {
            if (!skills || !Array.isArray(skills) || skills.length === 0) {
                return '<div class="alert alert-warning rounded-lg shadow-sm">' +
                    '<i class="fas fa-exclamation-circle mr-2"></i> No skills found</div>';
            }

            var tableRows = '';
            for (var i = 0; i < skills.length; i++) {
                var skill = skills[i];
                tableRows += '<tr class="skill-row">' +
                    '<td class="font-weight-medium">' + (skill.skill || 'N/A') + '</td>' +
                    '<td><span class="badge badge-info">' + (skill.experience || 'N/A') + '</span></td>' +
                    '<td>' + (skill.lastUsed || 'N/A') + '</td>' +
                    '<td>' + (skill.version || 'N/A') + '</td>' +
                    '</tr>';
            }

            return '<div class="table-responsive card shadow-sm">' +
                '<table class="table table-hover mb-0">' +
                '<thead class="bg-gradient-primary text-white">' +
                '<tr><th class="border-0">Skill</th>' +
                '<th class="border-0">Experience</th>' +
                '<th class="border-0">Last Used</th>' +
                '<th class="border-0">Version</th></tr>' +
                '</thead><tbody>' + tableRows + '</tbody></table></div>';
        },

        /**
         * Renders certifications
         */
        certifications: function (certs) {
            if (!certs || !Array.isArray(certs) || certs.length === 0) {
                return '<div class="alert alert-warning rounded-lg shadow-sm">' +
                    '<i class="fas fa-exclamation-circle mr-2"></i> No certifications found</div>';
            }

            var listItems = '';
            for (var i = 0; i < certs.length; i++) {
                var cert = certs[i];
                listItems += '<li class="list-group-item d-flex justify-content-between align-items-center">' +
                    '<div><i class="fas fa-certificate text-primary mr-2"></i>' +
                    '<span class="font-weight-medium">' + (cert.course || 'N/A') + '</span></div>' +
                    '<span class="badge badge-soft-primary badge-pill">' + (cert.vendor || 'N/A') + '</span>' +
                    '</li>';
            }

            return '<div class="card shadow-sm p-0">' +
                '<ul class="list-group list-group-flush">' +
                listItems + '</ul></div>';
        },

        /**
         * Renders projects
         */
        projects: function (projects) {
            if (!projects || !Array.isArray(projects) || projects.length === 0) {
                return '<div class="alert alert-warning rounded-lg shadow-sm">' +
                    '<i class="fas fa-exclamation-circle mr-2"></i> No projects found</div>';
            }

            var listItems = '';
            for (var i = 0; i < projects.length; i++) {
                var project = projects[i];
                listItems += '<li class="list-group-item d-flex justify-content-between align-items-center">' +
                    '<div><i class="fas fa-project-diagram text-primary mr-2"></i>' +
                    '<span class="font-weight-medium">' + (project.name || 'N/A') + '</span></div>' +
                    '<span class="badge badge-soft-info badge-pill">' + (project.duration || 'N/A') + '</span>' +
                    '</li>';
            }

            return '<div class="card shadow-sm p-0">' +
                '<ul class="list-group list-group-flush">' +
                listItems + '</ul></div>';
        },

        /**
         * Renders language proficiencies
         */
        languages: function (languages) {
            if (!languages || !Array.isArray(languages) || languages.length === 0) {
                return '<div class="alert alert-warning rounded-lg shadow-sm">' +
                    '<i class="fas fa-exclamation-circle mr-2"></i> No language information found</div>';
            }

            function getProficiencyColor(proficiency) {
                switch (proficiency) {
                    case 'Expert': return 'success';
                    case 'Proficient': return 'info';
                    default: return 'primary';
                }
            }

            function getProficiencyWidth(proficiency) {
                switch (proficiency) {
                    case 'Expert': return '100%';
                    case 'Proficient': return '75%';
                    default: return '50%';
                }
            }

            var tableRows = '';
            for (var i = 0; i < languages.length; i++) {
                var lang = languages[i];
                var color = getProficiencyColor(lang.proficiency);
                var width = getProficiencyWidth(lang.proficiency);
                var value = lang.proficiency === 'Expert' ? '100' :
                    lang.proficiency === 'Proficient' ? '75' : '50';

                tableRows += '<tr class="language-row">' +
                    '<td class="font-weight-medium">' + (lang.language || 'N/A') + '</td>' +
                    '<td><div class="progress" style="height: 6px;">' +
                    '<div class="progress-bar bg-' + color + '" role="progressbar" ' +
                    'style="width: ' + width + '" aria-valuenow="' + value + '" ' +
                    'aria-valuemin="0" aria-valuemax="100"></div></div>' +
                    '<small class="mt-1 d-block text-' + color + '">' +
                    (lang.proficiency || 'N/A') + '</small></td>' +
                    '<td class="text-muted small">' + (lang.capabilities || 'N/A') + '</td>' +
                    '</tr>';
            }

            return '<div class="table-responsive card shadow-sm">' +
                '<table class="table table-hover mb-0">' +
                '<thead class="bg-gradient-primary text-white">' +
                '<tr><th class="border-0">Language</th>' +
                '<th class="border-0" style="width: 40%">Proficiency</th>' +
                '<th class="border-0">Capabilities</th></tr>' +
                '</thead><tbody>' + tableRows + '</tbody></table></div>';
        },

        /**
         * Renders skill summary (key skills, additional skills, assessed skills)
         */
        skills: function (skillsData) {
            if (!skillsData || typeof skillsData !== 'object') {
                return '<div class="alert alert-warning rounded-lg shadow-sm">' +
                    '<i class="fas fa-exclamation-circle mr-2"></i> No skills information found</div>';
            }

            var html = '';

            // Key Skills
            if (skillsData.keySkills && skillsData.keySkills.length > 0) {
                var keySkillBadges = '';
                for (var i = 0; i < skillsData.keySkills.length; i++) {
                    keySkillBadges += '<span class="badge badge-soft-secondary m-1 py-2 px-3">' +
                        skillsData.keySkills[i] + '</span>';
                }

                html += '<div class="mb-4">' +
                    '<h6 class="text-primary d-flex align-items-center">' +
                    '<i class="fas fa-star mr-2"></i>Key Skills</h6>' +
                    '<div class="d-flex flex-wrap">' + keySkillBadges + '</div></div>';
            }

            // Additional Skills
            if (skillsData.additionalSkills && skillsData.additionalSkills.length > 0) {
                var additionalSkillBadges = '';
                for (var j = 0; j < skillsData.additionalSkills.length; j++) {
                    additionalSkillBadges += '<span class="badge badge-soft-secondary m-1 py-2 px-3">' +
                        skillsData.additionalSkills[j] + '</span>';
                }

                html += '<div class="mb-4">' +
                    '<h6 class="text-primary d-flex align-items-center">' +
                    '<i class="fas fa-plus-circle mr-2"></i>Additional Skills</h6>' +
                    '<div class="d-flex flex-wrap">' + additionalSkillBadges + '</div></div>';
            }

            // Assessed Skills
            if (skillsData.assessedSkills && skillsData.assessedSkills.length > 0) {
                var assessedSkillBadges = '';
                for (var k = 0; k < skillsData.assessedSkills.length; k++) {
                    assessedSkillBadges += '<span class="badge badge-soft-success m-1 py-2 px-3">' +
                        skillsData.assessedSkills[k] + '</span>';
                }

                html += '<div class="mb-4">' +
                    '<h6 class="text-primary d-flex align-items-center">' +
                    '<i class="fas fa-check-circle mr-2"></i>Naukari Assessed Skills</h6>' +
                    '<div class="d-flex flex-wrap">' + assessedSkillBadges + '</div></div>';
            }

            return html || '<div class="alert alert-warning rounded-lg shadow-sm">' +
                '<i class="fas fa-exclamation-circle mr-2"></i> No skills data available</div>';
        }
    };

    /**
     * Main function to render the entire resume view
     * @param {string} jsonData - JSON string containing resume data
     * @param {boolean} contactless - Whether to hide contact information
     */
    function viewResumeDetails(jsonData, divId, contactless) {
        try {
            if (!divId) {
                throw new Error("No divId provided");
            }
            if (!jsonData) {
                throw new Error("No JSON data found");
            }

            if (!isJSON(jsonData)) {
                throw new Error("Invalid JSON data");
            }

            //if jsonData contains any invalid characters, remove them
            //jsonData = jsonData.replace(/[^a-zA-Z0-9{}[\],:.\-\" ]/g, '');

            var parsedData = JSON.parse(jsonData);
            //console.log(parsedData);

            // Add global styles
            var html = '<style>' +
                '@import url("https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap");' +
                '#view-container {font-family: "Inter", sans-serif; color: #495057; line-height: 1.6;}' +
                '.bg-gradient-primary {background: linear-gradient(135deg, #4e73df 0%, #224abe 100%);}' +
                '.profile-header h1 {font-weight: 700; letter-spacing: -0.02em;}' +
                '.section-container {border-radius: 8px; transition: all 0.2s;}' +
                '.section-container:hover {box-shadow: 0 0.125rem 0.25rem rgba(0, 0, 0, 0.08);}' +
                '.section-title {font-weight: 600; color: #364fc7; display: flex; align-items: center; margin-bottom: 1rem;}' +
                '.badge-soft-primary {color: #364fc7; background-color: rgba(78, 115, 223, 0.1);}' +
                '.badge-soft-secondary {color: #5a6268; background-color: rgba(90, 98, 104, 0.1);}' +
                '.badge-soft-success {color: #1cc88a; background-color: rgba(28, 200, 138, 0.1);}' +
                '.badge-soft-info {color: #36b9cc; background-color: rgba(54, 185, 204, 0.1);}' +
                '.card {border: none; border-radius: 8px; overflow: hidden;}' +
                '.experience-row:hover, .education-row:hover, .skill-row:hover, .language-row:hover {' +
                'background-color: rgba(78, 115, 223, 0.05);}' +
                '.list-group-item {border-left: none; border-right: none; transition: all 0.2s;}' +
                '.list-group-item:hover {background-color: rgba(78, 115, 223, 0.05);}' +
                '@keyframes fadeInUp {from {opacity: 0; transform: translateY(20px);} ' +
                'to {opacity: 1; transform: translateY(0);}}' +
                '@keyframes fadeOutDown {from {opacity: 1; transform: translateY(0);} ' +
                'to {opacity: 0; transform: translateY(20px);}}' +
                '</style>';

            // Render important details (header)
            if (parsedData.importantDetails) {
                var important = parsedData.importantDetails;

                // Handle mobile number format
                if (important.mobile === '+91') {
                    important.mobile = 'N/A';
                }

                if (contactless) {
                    html += '<div class="bg-gradient-primary text-white p-4 rounded-lg shadow profile-header">' +
                        '<div class="row">' +
                        '<div class="col-md-8">' +
                        '<h1 class="display-4 mb-2">' + (important.name.split(' ')[0] || 'N/A') + '</h1>' +
                        '<p class="lead"><i class="fas fa-briefcase mr-2"></i>' +
                        (important.experience || 'N/A') + ' of experience</p>' +
                        '</div></div></div>' +
                        '<div class="p-4 border-bottom section-container bg-white shadow-sm rounded-lg mt-4">' +
                        '<h4 class="section-title"><i class="fas fa-star mr-2"></i>Primary Skills</h4>' +
                        '<div class="d-flex flex-wrap">';

                    // Split primary skills by semicolon
                    var primarySkills = (important.primarySkills || 'N/A').split(';');
                    for (var i = 0; i < primarySkills.length; i++) {
                        var skill = primarySkills[i].trim();
                        if (skill) {
                            html += '<span class="badge badge-soft-primary m-1 py-2 px-3">' + skill + '</span>';
                        }
                    }

                    html += '</div></div>';
                } else {
                    html += '<div class="bg-gradient-primary text-white p-4 rounded-lg shadow profile-header">' +
                        '<div class="row">' +
                        '<div class="col-md-8">' +
                        '<h1 class="display-4 mb-2">' + (important.name || 'N/A') + '</h1>' +
                        '<p class="lead"><i class="fas fa-briefcase mr-2"></i>' +
                        (important.experience || 'N/A') + ' of experience</p>' +
                        '</div>' +
                        '<div class="col-md-4 text-md-right">' +
                        '<ul class="list-unstyled">' +
                        '<li class="mb-2"><i class="fas fa-envelope mr-2"></i>' + (important.email || 'N/A') + '</li>' +
                        '<li><i class="fas fa-phone mr-2"></i>' + (important.mobile || 'N/A') + '</li>' +
                        '</ul></div></div></div>' +
                        '<div class="p-4 border-bottom section-container bg-white shadow-sm rounded-lg mt-4">' +
                        '<h4 class="section-title"><i class="fas fa-star mr-2"></i>Primary Skills</h4>' +
                        '<div class="d-flex flex-wrap">';

                    // Split primary skills by semicolon
                    var primarySkills = (important.primarySkills || 'N/A').split(';');
                    for (var i = 0; i < primarySkills.length; i++) {
                        var skill = primarySkills[i].trim();
                        if (skill) {
                            html += '<span class="badge badge-soft-primary m-1 py-2 px-3">' + skill + '</span>';
                        }
                    }

                    html += '</div></div>';
                }
            } else {
                displayStatus("No important details found", "warning");
            }

            // Render other sections if available
            if (parsedData.otherDetails) {
                var other = parsedData.otherDetails;

                // Profile summary
                if (other.profileSummary) {
                    html += '<div class="p-4 section-container bg-white shadow-sm rounded-lg mt-4">' +
                        '<h4 class="section-title"><i class="fas fa-user mr-2"></i>Profile Summary</h4>' +
                        '<p class="text-muted">' + other.profileSummary + '</p></div>';
                }

                // Current role
                if (other.currentRole) {
                    html += '<div class="p-4 section-container bg-white shadow-sm rounded-lg mt-4">' +
                        '<h4 class="section-title"><i class="fas fa-briefcase mr-2"></i>Current Role</h4>' +
                        '<div class="row">' +
                        '<div class="col-md-4">' +
                        '<div class="card bg-light p-3">' +
                        '<h6 class="text-primary mb-2">Company</h6>' +
                        '<p class="mb-0 font-weight-medium">' + (other.currentRole.company || 'N/A') + '</p>' +
                        '</div></div>' +
                        '<div class="col-md-4">' +
                        '<div class="card bg-light p-3">' +
                        '<h6 class="text-primary mb-2">Position</h6>' +
                        '<p class="mb-0 font-weight-medium">' + (other.currentRole.position || 'N/A') + '</p>' +
                        '</div></div>' +
                        '<div class="col-md-4">' +
                        '<div class="card bg-light p-3">' +
                        '<h6 class="text-primary mb-2">Since</h6>' +
                        '<p class="mb-0 font-weight-medium">' + (other.currentRole.since || 'N/A') + '</p>' +
                        '</div></div></div></div>';
                }

                // Job info
                if (other.jobInfo) {
                    html += '<div class="p-4 section-container bg-white shadow-sm rounded-lg mt-4">' +
                        '<h4 class="section-title"><i class="fas fa-info-circle mr-2"></i>Job Information</h4>' +
                        '<div class="row">' +
                        '<div class="col-md-3">' +
                        '<div class="card bg-light p-3">' +
                        '<h6 class="text-primary mb-2">Current Salary</h6>' +
                        '<p class="mb-0 font-weight-medium">' + (other.jobInfo.currentSalary || 'N/A') + '</p>' +
                        '</div></div>' +
                        '<div class="col-md-3">' +
                        '<div class="card bg-light p-3">' +
                        '<h6 class="text-primary mb-2">Expected Salary</h6>' +
                        '<p class="mb-0 font-weight-medium">' + (other.jobInfo.expectedSalary || 'N/A') + '</p>' +
                        '</div></div>' +
                        '<div class="col-md-3">' +
                        '<div class="card bg-light p-3">' +
                        '<h6 class="text-primary mb-2">Location</h6>' +
                        '<p class="mb-0 font-weight-medium">' + (other.jobInfo.location || 'N/A') + '</p>' +
                        '</div></div>' +
                        '<div class="col-md-3">' +
                        '<div class="card bg-light p-3">' +
                        '<h6 class="text-primary mb-2">Notice Period</h6>' +
                        '<p class="mb-0 font-weight-medium">' + (other.jobInfo.noticePeriod || 'N/A') + '</p>' +
                        '</div></div>';

                    // Add LinkedIn if not contactless
                    if (!contactless && other.jobInfo.linkedin) {
                        html += '<div class="col-md-3 mt-3">' +
                            '<div class="card bg-light p-3">' +
                            '<h6 class="text-primary mb-2">LinkedIn</h6>' +
                            '<p class="mb-0 font-weight-medium"><a href="' +
                            (other.jobInfo.linkedin || '#') + '" target="_blank">' +
                            (other.jobInfo.linkedin || 'N/A') + '</a></p>' +
                            '</div></div>';
                    }

                    html += '</div></div>';
                }

                // Work experiences
                if (other.workExperiences) {
                    html += '<div class="p-4 section-container bg-white shadow-sm rounded-lg mt-4">' +
                        '<h4 class="section-title"><i class="fas fa-building mr-2"></i>Work Experience</h4>' +
                        renderers.workExperiences(other.workExperiences) +
                        '</div>';
                }

                // Education details
                if (other.educationDetails) {
                    var educationHtml = '<div class="p-4 section-container bg-white shadow-sm rounded-lg mt-4">' +
                        '<h4 class="section-title"><i class="fas fa-graduation-cap mr-2"></i>Education Details</h4>' +
                        renderers.educationDetails(other.educationDetails) +
                        '</div>';
                    html += educationHtml;
                }

                // Highest degree
                if (other.highestDegree) {
                    html += '<div class="p-4 section-container bg-white shadow-sm rounded-lg mt-4">' +
                        '<h4 class="section-title"><i class="fas fa-user-graduate mr-2"></i>Highest Degree</h4>' +
                        renderers.highestDegree(other.highestDegree) +
                        '</div>';
                }

                // Work summary
                if (other.workSummary) {
                    html += '<div class="p-4 section-container bg-white shadow-sm rounded-lg mt-4">' +
                        '<h4 class="section-title"><i class="fas fa-file-alt mr-2"></i>Work Summary</h4>' +
                        renderers.workSummary(other.workSummary) +
                        '</div>';
                }

                // Work authorization
                if (other.workAuthorization) {
                    html += '<div class="p-4 section-container bg-white shadow-sm rounded-lg mt-4">' +
                        '<h4 class="section-title"><i class="fas fa-passport mr-2"></i>Work Authorization</h4>' +
                        renderers.workAuthorization(other.workAuthorization) +
                        '</div>';
                }

                // Technical skills
                if (other.technicalSkills) {
                    html += '<div class="p-4 section-container bg-white shadow-sm rounded-lg mt-4">' +
                        '<h4 class="section-title"><i class="fas fa-cogs mr-2"></i>Technical Skills</h4>' +
                        renderers.technicalSkills(other.technicalSkills) +
                        '</div>';
                }

                // Certifications
                if (other.certifications) {
                    html += '<div class="p-4 section-container bg-white shadow-sm rounded-lg mt-4">' +
                        '<h4 class="section-title"><i class="fas fa-certificate mr-2"></i>Certifications</h4>' +
                        renderers.certifications(other.certifications) +
                        '</div>';
                }

                // Projects
                if (other.projects) {
                    html += '<div class="p-4 section-container bg-white shadow-sm rounded-lg mt-4">' +
                        '<h4 class="section-title"><i class="fas fa-project-diagram mr-2"></i>Projects</h4>' +
                        renderers.projects(other.projects) +
                        '</div>';
                }

                // Languages
                if (other.languages) {
                    html += '<div class="p-4 section-container bg-white shadow-sm rounded-lg mt-4">' +
                        '<h4 class="section-title"><i class="fas fa-language mr-2"></i>Languages</h4>' +
                        renderers.languages(other.languages) +
                        '</div>';
                }

                // Skills
                if (other.skills) {
                    html += '<div class="p-4 section-container bg-white shadow-sm rounded-lg mt-4">' +
                        '<h4 class="section-title"><i class="fas fa-tools mr-2"></i>Skills</h4>' +
                        renderers.skills(other.skills) +
                        '</div>';
                }
            }

            // Render the final HTML
            var container = document.getElementById(divId);
            container.innerHTML = html;
            //displayStatus("Resume details rendered successfully", "success");
        } catch (error) {
            console.error("Error rendering resume details:", error);
            displayStatus("Error rendering resume details: " + error.message, "danger");
        }
    };

    //return the viewResumeDetails function
    return {
        viewResumeDetails: viewResumeDetails
    };
})();

//call the viewResumeDetails function
ResumeViewer.viewResumeDetails(JSON.stringify(resumeData), "view-container", true);



